#启动应用

## 启动前检查主机，应用相关信息
 * 检测应用所属是否已分配应用程序。
   * 若无分配应用程序，则通知前端无法启动应用，因为应用还未分配应用程序
 * 检测应用所在主机是否在线。
   * 若无主机在线，则通知前端无法启动应用，因为应用所在主机均未在线
 * 检测当前用户是否已经有应用在线
   * 若在线活动，记录活动在线主机，是否和当前需要启动的应用有相同主机；相同主机，分是否为桌面、程序，
     ** 前任为桌面则关闭，重新创建会话；
     ** 前任为程序，当前为程序则替换；
     ** 前任为程序，当前为桌面，关闭前任重新创建会话；
  * 若当前应用所在主机，有不止一个在线，则匹配最大空闲那台主机。
     ** (筛选在线主机：有活动的在线主机，只有一个则直接关闭重启或替换；多个则取最大空闲的在线主机)
  * 若无在线活动主机，则通知前端新建一个会话
   
## 通知启动应用：
 * 检测应用所属是否已分配应用程序
 * 检测应用所在主机是否在线
 * 是否有前置应用，来辅助启动。方便前端替换流，实现同步。
 * 检测当前用户是否已经有应用在线
   * 若在线活动，记录活动在线主机，是否和当前需要启动的应用有相同主机；相同主机，分是否为桌面、程序，
     ** 前任为桌面则关闭，重新创建会话；
     ** 前任为程序，当前为程序则替换；
     ** 前任为程序，当前为桌面，关闭前任重新创建会话；
  * 若当前应用所在主机，有不止一个在线，则匹配最大空闲那台主机。
     ** (筛选在线主机：有活动的在线主机，只有一个则直接关闭重启或替换；多个则取最大空闲的在线主机)
   * 若无在线活动主机，则通知monitor启动应用程序

   
# SSO整合
 * 主页：获取所有分配应用后，去后端拉取已配置的sso数据。
   * 视图展示：
     1.未配置坐标；
     2.已配置坐标，且已配置账户信息；
     3.已配置坐标，但未配置账户信息；
 * 管理员配置SSO坐标页：获取所有分配应用后，去后端拉取已配置sso坐标数据的应用
   * 视图展示：
     1.未配置坐标
     2.已配置坐标
 * 配置SSO账户信息列表页面
   * 查看
   * 重新输入
   
# 在线应用替换时，各信息更新
  * 开始时间，及上一应用被替换时间，并保存至数据库(应用ID，开始时间，结束时间，应用名称)
  * 应用ID
  * 应用名称?

# 资源管理
  * 指令，视图展示页
  * 权限控制
  
# 主会话模式
 * 需要从WebSocket中继承下与crd联系的socket及tunnel相关信息
   * 当前端与后端发生中断，那么Websocket的onClose方法通知系统开始后台自动运行tunnel通道
   * 当前端恢复，则需要从系统中重新获取在后台运行的tunnel通道，并改变tunnel通道运行方式，通知系统将接管通讯交流

# 第三方认证平台认证，数据共享
  * 后端，认证请求方，请求->username，响应->username，token。
  * 第三方登录转发页面，需要将数据写入本地，以便跳转主页，向后端再次认证时，发生错误
   